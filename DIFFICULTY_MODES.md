# 难度选择功能说明

## 功能概述

为英语学习系统添加了智能难度选择功能，支持4种不同的学习模式，根据用户的学习水平和历史表现自动调整题目难度。

## 难度模式

### 1. 🤖 自动模式
- **功能**：根据历史正确率自动调整难度
- **算法**：
  - 分析用户在各等级（A1-C1）的历史正确率
  - 正确率高的等级减少题目权重
  - 正确率低的等级增加题目权重
  - 动态调整题目难度分布
- **适用场景**：有一定学习历史的用户，希望系统智能推荐

### 2. 🌱 小学生模式
- **功能**：只考A级题（A1-A2）
- **特点**：基础词汇，适合初学者
- **适用场景**：英语基础较弱，希望从简单词汇开始

### 3. 💪 高手模式
- **功能**：只考B级题（B1-B2）
- **特点**：中等难度词汇
- **适用场景**：有一定英语基础，希望挑战中等难度

### 4. 🔥 地狱模式
- **功能**：只考C级题（C1）
- **特点**：高难度词汇
- **适用场景**：英语水平较高，希望挑战最难词汇

### 5. ⚙️ 自定义模式
- **功能**：手动选择难度等级
- **特点**：保留原有的等级选择功能
- **适用场景**：希望针对特定等级进行练习

## 技术实现

### 数据结构更新

1. **类型定义** (`src/types/vocabulary.ts`)
   - 添加 `DifficultyMode` 类型
   - 扩展 `StudySession` 包含难度模式
   - 添加 `LevelStats` 用于等级统计

2. **存储服务** (`src/lib/storage.ts`)
   - 添加按等级统计正确率的功能
   - 实时更新单词等级统计
   - 提供等级准确率查询接口

3. **词汇服务** (`src/lib/vocabulary.ts`)
   - 实现智能难度调整算法
   - 支持按难度模式筛选单词
   - 提供难度模式配置管理

### UI界面更新

1. **设置面板**
   - 添加难度模式选择界面
   - 显示智能模式的统计信息
   - 动态显示/隐藏等级选择

2. **学习界面**
   - 显示当前难度模式
   - 实时更新等级统计

## 使用方法

1. **进入学习页面**
   - 访问 `/english/vocabulary` 或 `/english/vocabulary/review`

2. **选择难度模式**
   - 点击设置按钮打开学习设置
   - 在"难度模式"区域选择合适的模式
   - 自动模式会显示当前各等级的正确率统计

3. **开始学习**
   - 系统会根据选择的难度模式自动筛选对应的单词
   - 学习过程中会实时更新等级统计数据

## 测试页面

访问 `/test-difficulty` 可以测试各种难度模式的单词选择效果。

## 智能算法说明

自动模式的权重计算规则：
- 正确率 ≥ 90%：权重 0.1（大幅减少）
- 正确率 80-89%：权重 0.2（减少）
- 正确率 70-79%：权重 0.3（正常）
- 正确率 60-69%：权重 0.5（增加）
- 正确率 < 60%：权重 0.7（大幅增加）
- 无数据：权重 0.3（中等）

这样确保用户会更多练习掌握不好的等级，同时减少已经熟练的等级的题目。
